# ETPF

ref: Stochastic Event-Triggered Particle Filtering for State Estimation(2016)



The basic idea behind of event based sampling strategries is that information is transimitted from sensors to processing units only if certain events happen.

ETSE(envent triggered state estimation): systems states are estimated using event-triggered(ET) measurements and although sesnors measure the outputs of the system at each sampling instant, the measurements are sent to the estimator if the triggering condition is satisfied.  In this framework, once the measurements are received by the estimator, it updates the estimaion value and when it is not received, the estimator selects a predefined value. 



The previous works in the literature on ETSE can generally be categorized into two groups: development of novel event-triggering(ET) considitions and development of event-based estimation given a specific ET condition. 

To overcome the problem of costly communication and limitation in energy resources, sensor are equipped with event based data schedulers. A triggering index, $\gamma_k$ is considered to schedule the sensors communication in which, $\gamma_k = 0$ means an ET condition is not satisfied and no measurement is transferred. Once $\gamma_k = 1$ the measurements are transmitted to the estimator.  The stochastic ET strategy is selected as follows:
$$
\gamma_k = \left\{ \begin{aligned}0 & \quad if  \quad \phi(y_k,y_{l_k}) > \theta_k \\
1&\quad otherwise\end{aligned} \right.
$$
where $\phi()$ is a triggering function which determines the information available to the estimator at the no-event instants, $\theta_k$ is also considered as a random variable with a uniform distribution over $[0,1]$ . A stochastic send-on-delta with a Gaussian Kernel is considered in this paper as follows
$$
\phi(y_k,y_{l_k}) = exp(-\frac{1}{2} (y_k - y_{l_k})\Sigma(y_k - y_{l_k})^T
$$
where $\Sigma$ is a non-singular positive dent weighting matrix that determines the shape of the Gaussian Kernel. $y_{l_k}$ is the measurement vector sent by the sensor at the time instant $l_k$ which is the last information received by the estimator. 



The measurement information received by the estimator is denoted as follows:
$$
Y_k = \left\{
\begin{aligned}
y_k & \quad \gamma_k = 1 \\
Y_k & \quad \gamma_k = 0
\end{aligned}
\right.
$$

## ET PF

In the first case, ET condition is not satisfied and thus the measurements are not received by the estimator. In the second case, the ET condition is satisfied and the estimator receives the current measurements.

**First Case**

Using the Bayesian rule, it follows that
$$
p(x_k|I_k) = p(x_k|\gamma_k =0,I_{k-1})=\frac{p(\gamma_k = 0|x_k,I_{k-1})}{p(\gamma_k=0|I_{k-1})}p(x_k|I_{k-1})
$$

$$
p(x_k|I_{k-1})=\frac{1}{N}\sum_{i=1}^N p(x_k|x_{k-1}^{i+},I_{k-1})
$$


$p(x_k|x_{k-1}^{i+},I_{k-1})$ is approximated by $\delta(x_k - x_k^{i-})$ which yields:


$$
p(x_k|I_{k-1}) \sim \frac{1}{N}\sum \delta(x_k - x_k^{i-})\\
p(x_k|I_{k}) \sim \frac{1}{N}\sum w_k^i\delta(x_k - x_k^{i-})\\
$$
where $w_k^i$ is the weight corresponding to the $i-$th particle.

**Second Case**



## Event-based Particle Filtering

ref: Event-based Particle Filtering for Robot Self-Localization

Event based sensors have three advantages over normal synchroized image sensors. First, the amount of data generated by the sensor is much smaller as only changes in the image are transimitted and not the complete image state.  Second, suitable for high speed control applications. Finally, the sensor implicitly provides pre-processing for tracking applications which often rely on detecting changes in the image. 



The sensor can not see still objects. 

# Event-based Sampling

ref: Event-Based Control and signal processing

https://books.google.com/books?hl=zh-CN&lr=&id=b_QYCwAAQBAJ&oi=fnd&pg=PA261&dq=event-based+CPHD+filter+event-triggered&ots=VjpYIqbKpG&sig=tleIsZORhFbs_R6LROe4PAcQ28k#v=onepage&q&f=false

page 267

Event-Based sampling is a-periodically sampling strategy where events are not triggered periodically in time but at instants of predefined events.  Three examples are "Send-On-Delta"

,"Predictive Sampling" and "Matched Sampling"

1. Send-On-Delta(SOD)
   $$
   t_e = inf \left\{t > t_{e-1}| ||y(t) - y(t_{e-1})||  > \Delta(t)\right\}
   $$

2. Predictive Sampling
   $$
   t_e = inf  \left\{ t>t_{e-1} | ||y(t) - \hat{y}(t)||  > \Delta(t) \right\}
   $$

3. Matched Sampling
   $$
   t_e = inf \left\{ t > t_{e-1}| ||D_{kl}(p_1(x(t)),p_2(x(t)))|| > \Delta(t) \right\}
   $$




Matched Sampling uses the KL divergence for triggering new events. This divergence, denoted as $D_{kl}(p_1(x),p_2(x)$.  $p_1(x)$ is considered to be the updated PDF of x and $p_2(x)$ is a prediction of $p_1(x)$. In line with this reasoning let $p_2(x)$ denote the prediction of $x(t)$ base on the result at $t_{e-1}$, while $p_1(x(t))$ is the update of $p_2(x)$ with the sensor value $y(t)$. 



## Stochastic Representations

The sEBSE finds an single Gaussian approximation.

**Step 1**  Compute the prediction from the process model and the estimation result at $t_{k-1}$. The kalman filter equation can be used to find the predicted PDF, for some sampling time $\tau_k = t_{k} - t_{k-1}$, that is,
$$
p(x(t_k) | \mathcal{Y}_{0:k-1}) = \mathcal{G}(x(t_k),\hat{x}(t_k^-),P(t_k^-))
$$
where
$$
\hat{x}(t_k^-) = F \hat{x}(t_{k-1})
$$

$$
P(t_k^-)) = F P(t_{k-1})F+Q
$$

**Step2** Formulate the likelihood $p(y(t_k)|x(t_k))$ as a sum of N Gaussian and employ a sum of Gaussian approach to solve $p(x(t_k)|\mathcal{Y_{0:k}})$

#  Cooperative Target

ref:Event-triggered cooperative target tracking in
wireless sensor networks

# Event Based State Estimation With Time Synchronous Updates

ref Event Based State Estimation With Time Synchronous Updates(2012 IEEE TRANSACTIONS ON AUTOMATIC CONTROL)

Two event sampling are "Send-onDelta" and "Integral Sampling". 

The goal of this paper is to design a stochastic state-estimator that is suitable for any type of event sampling strategy, enjoys an asymptotic bound on its error-covriance matrix and has a reasonable compuational complexity. 

The challenge in event based state estimation is an unknown time-horizon until the next event occurs, if it even occurs at all. Solutions with asynchronous estimators, perform a prediction of $x$ at the synchronous time instants as no measurement is received. It was shown that this leads to a diverging behavior of $P(t)$. 



# An event-triggered approach to state estimation with multiple pointand set-valued measurements

Each channel of the sensors has its own event-triggering condition, closed-form representations are derived for the optimal estimate and the corresponding error covraince matrix. 



## Scenario

The process is measured by a network of sensors and that each sensor choose to provide its latest measurement update according to its own event-triggering condition. 

**point-valued** measurement: For the sensors whoise sensor outputs are known to the estimator

**set-valued** measurement: For the sensors that the event-triggering conditions are not satisfied, some information containded in the event-trigger sets is known to the estimator as well.

Define the function
$$
h(X)=AXA^T + Q \\
g(x,\theta) = X - \theta H^T[HXH^T+R]^{-1}HX
$$

### optimal fusion

**Theorem** (1)The optimal prediction $x_k^0$ of the state $x_k$ and the corresponding covariance $P_k^0$ are given by
$$
x_k^0 = Ax_{k-1}^M\\
P_k^0 = h(P_{k-1}^M)
$$
(2) for $i \in \mathcal{N}_{0:M-1}$, the fusion of information from the $(i+1)$th  sensor leads to the following recursive state estimation equations

if $\gamma_k^{i+1} == 1$
$$
x_k^{i+1}=x_k^{i}+L_{k}^{i+1}(z_k^{i+1} - z_k^{i+1|i})\\
P_k^{i+1}=g(P_k^i)
$$
if $\gamma_k^{i+1} == 0$
$$
x_{k}^{i+1} = x_k^i
$$

# Event-triggered Kalman consensus filter over sensor networks

To reduce the amount of data of data transfer in sensor networks, the authors propose a KCF with an event-triggered communication protocol. The triggering decision is based on the send-on-delta transimission mechanism: each sensor transmits its local estimates to its neighbots only if the difference between the most recent transmitted  estimate and current estimate exceeds a tolerable threshold. 